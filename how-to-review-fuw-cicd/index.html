<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>How to Review Fuw Cicd &middot; </title>
        <meta name="description" content="Steps to review fuw-cicd">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.90.0" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="How to Review Fuw Cicd">
<meta property="og:description" content="Steps to review fuw-cicd">
<meta property="og:type" content="article">
<meta property="og:url" content="https://kencho51.github.io/how-to-review-fuw-cicd/">
        <link rel="stylesheet" href="https://kencho51.github.io/dist/site.css">
        <link rel="stylesheet" href="https://kencho51.github.io/dist/syntax.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
        
        
        <link rel="icon" href="/image/favicon.ico" type="/image" />
        <link rel="apple-touch-icon" sizes="180x180" href="/image/apple-touch-icon.png">
        <link rel="icon" type="image" sizes="32x32" href="/image/favicon-32x32.png">
        <link rel="icon" type="image" sizes="16x16" href="/image/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest.json">
    </head>
    <body>
        
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HESL282TL4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-HESL282TL4');
</script>

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="kencho51" href="https://kencho51.github.io/">kencho51</a>
                            </h1>
                        
                        <a class="button-square" href="https://kencho51.github.io/index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/kencho51" rel="me">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:kencho.gigascience@gmail.com">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a href="/reference/hugoisforlovers/">Getting Started with Hugo</a>
    </li>


                    </ul>
                </div>
            </header>

            <div id="container">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-166952674-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-166952674-1');
</script>



<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">How to Review Fuw Cicd</h1>
    
        <p class="post-description" itemprop="description">Steps to review fuw-cicd</p>
    
    <p class="post-date post-line">
        <span>Published <time datetime="2021-05-20" itemprop="datePublished">Thu, May 20, 2021</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="#" itemprop="url" rel="author">Ken Cho</a>
            </span>
        </span>
    </p>
    
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <h1 id="pr546-details-at-herehttpsgithubcomgigasciencegigadb-websitepull546-gisthttpsgistgithubcomkencho516b5cebd15c9419484e73b2439a34f0d1">PR546 details at <a href="https://github.com/gigascience/gigadb-website/pull/546">here</a>, <a href="https://gist.github.com/kencho51/6b5cebd15c9419484e73b2439a34f0d1">gist</a></h1>
<h1 id="suggestion-from-rija-google-dochttpsdocsgooglecomdocumentd1ns_okarn6mxtcdw37jbrsgzzilzfrgpzjq2ope2euswedit">Suggestion from Rija, google <a href="https://docs.google.com/document/d/1Ns_OkaRn6mXtcDW37JbrSGZzILzFRGPZJQ2oPe2EuSw/edit">doc</a></h1>
<p>here&rsquo;s a suggestion on how to review and merge</p>
<ol start="0">
<li>
<p>Me: Rebase the latest change (the &ldquo;Use CSV file to provide data for test&rdquo; PR I saw you&rsquo;ve just merged Peter)</p>
</li>
<li>
<p>You: get the branch deployed and working (all tests passing and deployed to AWS)</p>
</li>
<li>
<p>You: make a list of areas of the codebase that you think was changed or added</p>
</li>
<li>
<p>Me: I&rsquo;ll add additional/orthogonal areas to the list I think are missing/worth talking about  if any</p>
</li>
<li>
<p>All of us: for each area, we organise meetings over Zoom (one per area or we bundle areas whenever it makes sense) for a group code review of that area(s) where I walk you through the changes.</p>
</li>
<li>
<p>All of us: you spend more time in areas you want to understand more while I make the changes necessary at this time resulting from any eventual feedback</p>
</li>
<li>
<p>You: merge the resulting branch to &ldquo;develop&rdquo;</p>
</li>
</ol>
<h2 id="progress">Progress</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> 0. Clone the repo to local</li>
<li><input checked="" disabled="" type="checkbox"> 1. Building Stage: Setup, run tests and project structure <a href="https://github.com/gigascience/gigadb-website/issues/642">#642</a>
<ul>
<li><input checked="" disabled="" type="checkbox"> 1. Go through the steps mentioned in the FUW workflow <a href="https://drive.google.com/file/d/1kkMMApX0J8Fcyt8ftwCe2PKPrtu5rQ6N/view?usp=sharing">video</a></li>
<li><input checked="" disabled="" type="checkbox"> 2. Pass Unit test</li>
<li><input checked="" disabled="" type="checkbox"> 3. Pass Functional test</li>
<li><input checked="" disabled="" type="checkbox"> 4. Pass Acceptance test</li>
<li><input checked="" disabled="" type="checkbox"> 5. Pass Coverage Test</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> 2. Changes to test infrastructure <a href="https://github.com/gigascience/gigadb-website/issues/643">#643</a>, <a href="https://github.com/yiisoft/yii2-app-basic">yii2 basic project templates</a></li>
<li><input disabled="" type="checkbox"> 3. Review Javascript application <a href="https://github.com/gigascience/gigadb-website/issues/644">#644</a></li>
<li><input disabled="" type="checkbox"> 4. Review Javascript application for File Upload Wizard <a href="https://github.com/gigascience/gigadb-website/issues/645">#645</a></li>
<li><input disabled="" type="checkbox"> 5. Review Javascript pipeline <a href="https://github.com/gigascience/gigadb-website/issues/646">#646</a></li>
<li><input disabled="" type="checkbox"> 6. File Upload Wizard Yii2 app <a href="https://github.com/gigascience/gigadb-website/issues/647">#647</a></li>
<li><input disabled="" type="checkbox"> 7. TUS and Uppy <a href="https://github.com/gigascience/gigadb-website/issues/648">#648</a></li>
<li><input disabled="" type="checkbox"> 8. Gitlab pipeline <a href="https://github.com/gigascience/gigadb-website/issues/649">#649</a></li>
<li><input disabled="" type="checkbox"> 9. Beanstalkd message queue <a href="https://github.com/gigascience/gigadb-website/issues/650">#650</a></li>
<li><input disabled="" type="checkbox"> 10. Flysystem modular storage client API <a href="https://github.com/gigascience/gigadb-website/issues/651">#651</a></li>
<li><input disabled="" type="checkbox"> 11. SOLID, fluent interface and controllers <a href="https://github.com/gigascience/gigadb-website/issues/652">#652</a></li>
<li><input disabled="" type="checkbox"> 12. Remove duplicated code and other miscellaneous changes <a href="https://github.com/gigascience/gigadb-website/issues/653">#653</a></li>
</ul>
<h3 id="steps-to-review---clone-the-repo">Steps to review - Clone the repo</h3>
<ol>
<li>
<p>Clone the target repo
<code>git clone https://github.com/rija/gigadb-website.git</code></p>
</li>
<li>
<p>Set the upstream
<code>git remote add upstream https://github.com/gigascience/gigadb-website.git</code></p>
</li>
<li>
<p>Sync the local <code>develop</code> with <code>upstream/develop</code></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">git checkout develop
git fetch upstream
git rebase upstream/develop
</code></pre></div><ol start="4">
<li>Sync the feature branch <code>fuw-cicd</code> with local <code>develop</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">git checkout fuw-cicd
git fetch origin
git rebase develop
</code></pre></div><h5 id="review-1">Review 1</h5>
<p>To fix a merge conflict,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Auto-merging protected/components/StoredDatasetConnections.php
CONFLICT <span class="o">(</span>content<span class="o">)</span>: Merge conflict in protected/components/StoredDatasetConnections.php
error: could not apply 57148420d... Fix acceptance tests and alleviate DOI resolver timeout
</code></pre></div><p><code>git rebase --continue</code></p>
<h3 id="steps-to-review---building-stage">Steps to review - Building Stage</h3>
<ol start="0">
<li>
<p>Remove all existing container database config
<code>rm -rf ~/.container-data/default-gigadb</code></p>
</li>
<li>
<p>List, stop and remove all running containers</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">docker ps
docker stop <span class="k">$(</span>docker ps -aq<span class="k">)</span>
docker rm <span class="k">$(</span>docker ps -aq<span class="k">)</span>
</code></pre></div><ol start="2">
<li>Get started
<code>./up.sh</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">+ <span class="nb">echo</span> <span class="s1">&#39;Starting all services...&#39;</span>
Starting all services...
+ docker stop socat
Error response from daemon: No such container: socat
+ docker run --name socat -d -v /var/run/docker.sock:/var/run/docker.sock -p 127.0.0.1:2375:2375 bobrik/socat TCP-LISTEN:2375,fork UNIX-CONNECT:/var/run/docker.sock
Unable to find image <span class="s1">&#39;bobrik/socat:latest&#39;</span> locally
latest: Pulling from bobrik/socat
Image docker.io/bobrik/socat:latest uses outdated schema1 manifest format. Please upgrade to a schema2 image <span class="k">for</span> better future compatibility. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/
de1f1ae900b1: Pull <span class="nb">complete</span> 
0ddb9b45f8f3: Pull <span class="nb">complete</span> 
a3ed95caeb02: Pull <span class="nb">complete</span> 
Digest: sha256:afea7dbd06940b9979cec0f1b9e8ccb7111d6feb671687ba9281a57136c1564e
Status: Downloaded newer image <span class="k">for</span> bobrik/socat:latest
83195d9bf8b947adaaccd46fce33100952746bdcdf0e5b263388381f6fd29153
+ <span class="s1">&#39;[&#39;</span> -f ./.env <span class="s1">&#39;]&#39;</span>
+ <span class="nb">read</span> -sp <span class="s1">&#39;To create .env, enter your private gitlab token and name of the name of your fork on GitLab: &#39;</span> token
To create .env, enter your private gitlab token and name of the name of your fork on GitLab:
</code></pre></div><h5 id="review-2">Review 2</h5>
<p><code>To create .env, enter your private gitlab token and name of the name of your fork on GitLab: </code> is not clear, change it to:<br>
<code>To create .env, enter your private gitlab token</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Variables to create .env 
name of your fork on GitLab: kencho51-gigadb-website
private gitlab token:
</code></pre></div><ol start="3">
<li>Rerun <code>./up.sh</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">+ <span class="nb">echo</span> <span class="s1">&#39;Starting all services...&#39;</span>
Starting all services...
+ docker stop socat
socat
+ docker rm socat
socat
+ docker run --name socat -d -v /var/run/docker.sock:/var/run/docker.sock -p 127.0.0.1:2375:2375 bobrik/socat TCP-LISTEN:2375,fork UNIX-CONNECT:/var/run/docker.sock
9d27b8fcc8698924d73cc1a6deabb9a3272acbfdfdca29fb7f3ce41a974b17ce
+ <span class="s1">&#39;[&#39;</span> -f ./.env <span class="s1">&#39;]&#39;</span>
+ <span class="nb">read</span> -sp <span class="s1">&#39;To create .env, enter your private gitlab token and name of the name of your fork on GitLab: &#39;</span> token
To create .env, enter your private gitlab token and name of the name of your fork on GitLab: + <span class="nb">read</span> -p <span class="s1">&#39;To create .env, enter the name of your fork on GitLab: &#39;</span> reponame
To create .env, enter the name of your fork on GitLab: kencho51-gigadb-website
+ cp ops/configuration/variables/env-sample .env
+ sed -i.bak s/#GITLAB_PRIVATE_TOKEN<span class="o">=</span>/GITLAB_PRIVATE_TOKEN<span class="o">=</span>bxEkhUaWRpLNLrm7nYnQ/ .env
+ sed -i.bak <span class="s1">&#39;s/REPO_NAME=&#34;&lt;Your fork name here&gt;&#34;/REPO_NAME=&#34;kencho51-gigadb-website&#34;/&#39;</span> .env
+ rm .env.bak
+ docker-compose run --rm config
Creating deployment_config_run ... <span class="k">done</span>
Current working directory: /var/www
An .env file is present, sourcing it
Running /var/www/ops/scripts/generate_config.sh <span class="k">for</span> environment: dev
Retrieving variables from https://gitlab.com/api/v4/groups/gigascience/variables?per_page<span class="o">=</span><span class="m">100</span>
jq: error <span class="o">(</span>at &lt;stdin&gt;:0<span class="o">)</span>: Cannot index string with string <span class="s2">&#34;key&#34;</span>
</code></pre></div><h5 id="problem">Problem</h5>
<p><code>curl -s --header &quot;PRIVATE_TOKEN:bxEkhUaWRpLNLrm7nYnQ&quot; &quot;https://gitlab.com/api/v4/groups/gigascience/variables?per_page=100&quot;</code> is</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;message&#34;</span><span class="p">:</span><span class="s2">&#34;401 Unauthorized&#34;</span><span class="p">}</span>
</code></pre></div><h5 id="review-3">Review 3</h5>
<p>Request Gitlab permission for <code>GROUP</code><br>
Update <code>GROUP_VARIABLES_URL</code> in <code>.env</code><br>
<code>GROUP_VARIABLES_URL=&quot;https://gitlab.com/api/v4/groups/gigascience%2FForks/variables?per_page=100&quot;</code></p>
<ol start="4">
<li>Rerun <code>./up.sh</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">+ <span class="nb">echo</span> <span class="s1">&#39;Starting all services...&#39;</span>
Starting all services...
+ docker stop socat
socat
+ docker rm socat
socat
+ docker run --name socat -d -v /var/run/docker.sock:/var/run/docker.sock -p 127.0.0.1:2375:2375 bobrik/socat TCP-LISTEN:2375,fork UNIX-CONNECT:/var/run/docker.sock
a57ebfc289c5f1be12506d23db1258b16e35512b3a834bd3882489b17a7b250c
+ <span class="s1">&#39;[&#39;</span> -f ./.env <span class="s1">&#39;]&#39;</span>
+ docker-compose run --rm config
Creating deployment_config_run ... <span class="k">done</span>
Current working directory: /var/www
An .env file is present, sourcing it
Running /var/www/ops/scripts/generate_config.sh <span class="k">for</span> environment: dev
Retrieving variables from https://gitlab.com/api/v4/groups/gigascience%2FForks/variables?per_page<span class="o">=</span><span class="m">100</span>
Retrieving variables from https://gitlab.com/api/v4/groups/3501869/variables
Retrieving variables from https://gitlab.com/api/v4/projects/gigascience%2Fforks%2Fkencho51-gigadb-website/variables
Sourcing secrets
Retrieving private_key variable <span class="k">for</span> Google API from https://gitlab.com/api/v4/projects/gigascience%2Fforks%2Fkencho51-gigadb-website/variables
* ---------------------------------------------- *
<span class="k">done</span>.
.
.
.
<span class="o">(</span>Running about 1hour<span class="o">)</span>
.
.
.
+ docker-compose up -d chrome
Creating deployment_chrome_1 ... 

ERROR: <span class="k">for</span> deployment_chrome_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> chrome  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>
ERROR: An HTTP request took too long to complete. Retry with --verbose to obtain debug information.
If you encounter this issue regularly because of slow network conditions, consider setting COMPOSE_HTTP_TIMEOUT to a higher value <span class="o">(</span>current value: 60<span class="o">)</span>.

</code></pre></div><p><code>$ docker ps</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">CONTAINER ID   IMAGE                                        COMMAND                  CREATED          STATUS          PORTS                                                        NAMES
e6c266106fc7   selenium/standalone-chrome:3.141.59-oxygen   <span class="s2">&#34;/opt/bin/entry_poinâ€¦&#34;</span>   <span class="m">13</span> minutes ago   Up <span class="m">10</span> minutes   0.0.0.0:4444-&gt;4444/tcp                                       deployment_chrome_1
ee98bde0c32f   deployment_web                               <span class="s2">&#34;/usr/local/bin/enabâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   0.0.0.0:9170-&gt;80/tcp, 0.0.0.0:8043-&gt;443/tcp                  deployment_web_1
6465ae74e7f0   deployment_fuw-admin                         <span class="s2">&#34;docker-php-entrypoiâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   9000/tcp, 9002/tcp                                           deployment_fuw-admin_1
898b9ce82485   deployment_fuw-public                        <span class="s2">&#34;docker-php-entrypoiâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   9000-9001/tcp                                                deployment_fuw-public_1
4343b2b35e0f   deployment_application                       <span class="s2">&#34;docker-php-entrypoiâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   9000/tcp                                                     deployment_application_1
6947a60f961f   deployment_console                           <span class="s2">&#34;docker-php-entrypoiâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   9000-9001/tcp                                                deployment_console_1
9fc5a2a1daa2   deployment_watcher                           <span class="s2">&#34;/sbin/boot.sh&#34;</span>          <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes                                                                deployment_watcher_1
5da97ed07996   deployment_tusd                              <span class="s2">&#34;tusd -dir /var/inboâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   1080/tcp                                                     deployment_tusd_1
d23cb014a7c6   postgres:9.6-alpine                          <span class="s2">&#34;docker-entrypoint.sâ€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   0.0.0.0:54321-&gt;5432/tcp                                      deployment_database_1
8690acc870db   deployment_ftpd                              <span class="s2">&#34;/run.sh -l puredb:/â€¦&#34;</span>   <span class="m">35</span> minutes ago   Up <span class="m">35</span> minutes   0.0.0.0:30000-30009-&gt;30000-30009/tcp, 0.0.0.0:9021-&gt;21/tcp   deployment_ftpd_1
a60fa71c68bc   bobrik/socat                                 <span class="s2">&#34;socat TCP-LISTEN:23â€¦&#34;</span>   <span class="m">58</span> minutes ago   Up <span class="m">58</span> minutes   127.0.0.1:2375-&gt;2375/tcp                                     socat
</code></pre></div><p><code>$ docker-compose log chrome</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Attaching to deployment_chrome_1
chrome_1             <span class="p">|</span> 2021-05-21 07:21:57,840 INFO Included extra file <span class="s2">&#34;/etc/supervisor/conf.d/selenium.conf&#34;</span> during parsing
chrome_1             <span class="p">|</span> 2021-05-21 07:21:57,846 INFO supervisord started with pid <span class="m">10</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:21:58,850 INFO spawned: <span class="s1">&#39;xvfb&#39;</span> with pid <span class="m">13</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:21:58,852 INFO spawned: <span class="s1">&#39;selenium-standalone&#39;</span> with pid <span class="m">14</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:21:58,858 INFO success: xvfb entered RUNNING state, process has stayed up <span class="k">for</span> &gt; than <span class="m">0</span> seconds <span class="o">(</span>startsecs<span class="o">)</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:21:58,859 INFO success: selenium-standalone entered RUNNING state, process has stayed up <span class="k">for</span> &gt; than <span class="m">0</span> seconds <span class="o">(</span>startsecs<span class="o">)</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:21:58,859 INFO exited: xvfb <span class="o">(</span><span class="nb">exit</span> status 0<span class="p">;</span> expected<span class="o">)</span>
chrome_1             <span class="p">|</span> 07:22:00.056 INFO <span class="o">[</span>GridLauncherV3.parse<span class="o">]</span> - Selenium server version: 3.141.59, revision: e82be7d358
chrome_1             <span class="p">|</span> 07:22:00.241 INFO <span class="o">[</span>GridLauncherV3.lambda<span class="nv">$buildLaunchers$3</span><span class="o">]</span> - Launching a standalone Selenium Server on port <span class="m">4444</span>
chrome_1             <span class="p">|</span> 2021-05-21 07:22:00.335:INFO::main: Logging initialized @1402ms to org.seleniumhq.jetty9.util.log.StdErrLog
chrome_1             <span class="p">|</span> 07:22:00.844 INFO <span class="o">[</span>WebDriverServlet.&lt;init&gt;<span class="o">]</span> - Initialising WebDriverServlet
chrome_1             <span class="p">|</span> 07:22:01.122 INFO <span class="o">[</span>SeleniumServer.boot<span class="o">]</span> - Selenium Server is up and running on port <span class="m">4444</span>
</code></pre></div><ol start="5">
<li>After checking, the <code>deployment_chrome_1</code> is up and running, so rerun <code>./up.sh</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">+ docker-compose <span class="nb">exec</span> console /app/yii migrate/fresh --interactive<span class="o">=</span><span class="m">0</span>
Yii Migration Tool <span class="o">(</span>based on Yii v2.0.42.1<span class="o">)</span>

Exception <span class="s1">&#39;yii\db\Exception&#39;</span> with message <span class="s1">&#39;SQLSTATE[08006] [7] could not translate host name &#34;dockerhost&#34; to address: Name or service not known&#39;</span>

in /app/vendor/yiisoft/yii2/db/Connection.php:649

Caused by: Exception <span class="s1">&#39;PDOException&#39;</span> with message <span class="s1">&#39;SQLSTATE[08006] [7] could not translate host name &#34;dockerhost&#34; to address: Name or service not known&#39;</span>

in /app/vendor/yiisoft/yii2/db/Connection.php:719

Stack trace:
<span class="c1">#0 /app/vendor/yiisoft/yii2/db/Connection.php(719): PDO-&gt;__construct(&#39;pgsql:host=dock...&#39;, &#39;fuw&#39;, &#39;vagrant&#39;, NULL)</span>
<span class="c1">#1 /app/vendor/yiisoft/yii2/db/Connection.php(638): yii\db\Connection-&gt;createPdoInstance()</span>
<span class="c1">#2 /app/vendor/yiisoft/yii2/db/Connection.php(1059): yii\db\Connection-&gt;open()</span>
<span class="c1">#3 /app/vendor/yiisoft/yii2/db/Connection.php(1046): yii\db\Connection-&gt;getMasterPdo()</span>
<span class="c1">#4 /app/vendor/yiisoft/yii2/db/Schema.php(463): yii\db\Connection-&gt;getSlavePdo()</span>
<span class="c1">#5 /app/vendor/yiisoft/yii2/db/Connection.php(938): yii\db\Schema-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#6 /app/vendor/yiisoft/yii2/db/Command.php(211): yii\db\Connection-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#7 /app/vendor/yiisoft/yii2/db/Command.php(1126): yii\db\Command-&gt;getRawSql()</span>
<span class="c1">#8 /app/vendor/yiisoft/yii2/db/Command.php(1147): yii\db\Command-&gt;logQuery(&#39;yii\\db\\Command:...&#39;)</span>
<span class="c1">#9 /app/vendor/yiisoft/yii2/db/Command.php(453): yii\db\Command-&gt;queryInternal(&#39;fetchAll&#39;, 7)</span>
<span class="c1">#10 /app/vendor/yiisoft/yii2/db/pgsql/Schema.php(182): yii\db\Command-&gt;queryColumn()</span>
<span class="c1">#11 /app/vendor/yiisoft/yii2/db/Schema.php(237): yii\db\pgsql\Schema-&gt;findTableNames(&#39;public&#39;)</span>
<span class="c1">#12 /app/vendor/yiisoft/yii2/db/Schema.php(780): yii\db\Schema-&gt;getTableNames(&#39;&#39;, false)</span>
<span class="c1">#13 /app/vendor/yiisoft/yii2/db/Schema.php(207): yii\db\Schema-&gt;getSchemaMetadata(&#39;&#39;, &#39;schema&#39;, false)</span>
<span class="c1">#14 /app/vendor/yiisoft/yii2/console/controllers/MigrateController.php(300): yii\db\Schema-&gt;getTableSchemas()</span>
<span class="c1">#15 /app/vendor/yiisoft/yii2/console/controllers/BaseMigrateController.php(472): yii\console\controllers\MigrateController-&gt;truncateDatabase()</span>
<span class="c1">#16 [internal function]: yii\console\controllers\BaseMigrateController-&gt;actionFresh()</span>
<span class="c1">#17 /app/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)</span>
<span class="c1">#18 /app/vendor/yiisoft/yii2/base/Controller.php(181): yii\base\InlineAction-&gt;runWithParams(Array)</span>
<span class="c1">#19 /app/vendor/yiisoft/yii2/console/Controller.php(184): yii\base\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#20 /app/vendor/yiisoft/yii2/base/Module.php(534): yii\console\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#21 /app/vendor/yiisoft/yii2/console/Application.php(181): yii\base\Module-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#22 /app/vendor/yiisoft/yii2/console/Application.php(148): yii\console\Application-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#23 /app/vendor/yiisoft/yii2/base/Application.php(392): yii\console\Application-&gt;handleRequest(Object(yii\console\Request))</span>
<span class="c1">#24 /app/yii(23): yii\base\Application-&gt;run()</span>
<span class="c1">#25 {main}</span>
2021-05-21 07:51:05 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>error<span class="o">][</span>yii<span class="se">\d</span>b<span class="se">\E</span>xception<span class="o">]</span> PDOException: SQLSTATE<span class="o">[</span>08006<span class="o">]</span> <span class="o">[</span>7<span class="o">]</span> could not translate host name <span class="s2">&#34;dockerhost&#34;</span> to address: Name or service not known in /app/vendor/yiisoft/yii2/db/Connection.php:719
Stack trace:
<span class="c1">#0 /app/vendor/yiisoft/yii2/db/Connection.php(719): PDO-&gt;__construct(&#39;pgsql:host=dock...&#39;, &#39;fuw&#39;, &#39;vagrant&#39;, NULL)</span>
<span class="c1">#1 /app/vendor/yiisoft/yii2/db/Connection.php(638): yii\db\Connection-&gt;createPdoInstance()</span>
<span class="c1">#2 /app/vendor/yiisoft/yii2/db/Connection.php(1059): yii\db\Connection-&gt;open()</span>
<span class="c1">#3 /app/vendor/yiisoft/yii2/db/Connection.php(1046): yii\db\Connection-&gt;getMasterPdo()</span>
<span class="c1">#4 /app/vendor/yiisoft/yii2/db/Schema.php(463): yii\db\Connection-&gt;getSlavePdo()</span>
<span class="c1">#5 /app/vendor/yiisoft/yii2/db/Connection.php(938): yii\db\Schema-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#6 /app/vendor/yiisoft/yii2/db/Command.php(211): yii\db\Connection-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#7 /app/vendor/yiisoft/yii2/db/Command.php(1126): yii\db\Command-&gt;getRawSql()</span>
<span class="c1">#8 /app/vendor/yiisoft/yii2/db/Command.php(1147): yii\db\Command-&gt;logQuery(&#39;yii\\db\\Command:...&#39;)</span>
<span class="c1">#9 /app/vendor/yiisoft/yii2/db/Command.php(453): yii\db\Command-&gt;queryInternal(&#39;fetchAll&#39;, 7)</span>
<span class="c1">#10 /app/vendor/yiisoft/yii2/db/pgsql/Schema.php(182): yii\db\Command-&gt;queryColumn()</span>
<span class="c1">#11 /app/vendor/yiisoft/yii2/db/Schema.php(237): yii\db\pgsql\Schema-&gt;findTableNames(&#39;public&#39;)</span>
<span class="c1">#12 /app/vendor/yiisoft/yii2/db/Schema.php(780): yii\db\Schema-&gt;getTableNames(&#39;&#39;, false)</span>
<span class="c1">#13 /app/vendor/yiisoft/yii2/db/Schema.php(207): yii\db\Schema-&gt;getSchemaMetadata(&#39;&#39;, &#39;schema&#39;, false)</span>
<span class="c1">#14 /app/vendor/yiisoft/yii2/console/controllers/MigrateController.php(300): yii\db\Schema-&gt;getTableSchemas()</span>
<span class="c1">#15 /app/vendor/yiisoft/yii2/console/controllers/BaseMigrateController.php(472): yii\console\controllers\MigrateController-&gt;truncateDatabase()</span>
<span class="c1">#16 [internal function]: yii\console\controllers\BaseMigrateController-&gt;actionFresh()</span>
<span class="c1">#17 /app/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)</span>
<span class="c1">#18 /app/vendor/yiisoft/yii2/base/Controller.php(181): yii\base\InlineAction-&gt;runWithParams(Array)</span>
<span class="c1">#19 /app/vendor/yiisoft/yii2/console/Controller.php(184): yii\base\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#20 /app/vendor/yiisoft/yii2/base/Module.php(534): yii\console\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#21 /app/vendor/yiisoft/yii2/console/Application.php(181): yii\base\Module-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#22 /app/vendor/yiisoft/yii2/console/Application.php(148): yii\console\Application-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#23 /app/vendor/yiisoft/yii2/base/Application.php(392): yii\console\Application-&gt;handleRequest(Object(yii\console\Request))</span>
<span class="c1">#24 /app/yii(23): yii\base\Application-&gt;run()</span>
<span class="c1">#25 {main}</span>

Next yii<span class="se">\d</span>b<span class="se">\E</span>xception: SQLSTATE<span class="o">[</span>08006<span class="o">]</span> <span class="o">[</span>7<span class="o">]</span> could not translate host name <span class="s2">&#34;dockerhost&#34;</span> to address: Name or service not known in /app/vendor/yiisoft/yii2/db/Connection.php:649
Stack trace:
<span class="c1">#0 /app/vendor/yiisoft/yii2/db/Connection.php(1059): yii\db\Connection-&gt;open()</span>
<span class="c1">#1 /app/vendor/yiisoft/yii2/db/Connection.php(1046): yii\db\Connection-&gt;getMasterPdo()</span>
<span class="c1">#2 /app/vendor/yiisoft/yii2/db/Schema.php(463): yii\db\Connection-&gt;getSlavePdo()</span>
<span class="c1">#3 /app/vendor/yiisoft/yii2/db/Connection.php(938): yii\db\Schema-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#4 /app/vendor/yiisoft/yii2/db/Command.php(211): yii\db\Connection-&gt;quoteValue(&#39;public&#39;)</span>
<span class="c1">#5 /app/vendor/yiisoft/yii2/db/Command.php(1126): yii\db\Command-&gt;getRawSql()</span>
<span class="c1">#6 /app/vendor/yiisoft/yii2/db/Command.php(1147): yii\db\Command-&gt;logQuery(&#39;yii\\db\\Command:...&#39;)</span>
<span class="c1">#7 /app/vendor/yiisoft/yii2/db/Command.php(453): yii\db\Command-&gt;queryInternal(&#39;fetchAll&#39;, 7)</span>
<span class="c1">#8 /app/vendor/yiisoft/yii2/db/pgsql/Schema.php(182): yii\db\Command-&gt;queryColumn()</span>
<span class="c1">#9 /app/vendor/yiisoft/yii2/db/Schema.php(237): yii\db\pgsql\Schema-&gt;findTableNames(&#39;public&#39;)</span>
<span class="c1">#10 /app/vendor/yiisoft/yii2/db/Schema.php(780): yii\db\Schema-&gt;getTableNames(&#39;&#39;, false)</span>
<span class="c1">#11 /app/vendor/yiisoft/yii2/db/Schema.php(207): yii\db\Schema-&gt;getSchemaMetadata(&#39;&#39;, &#39;schema&#39;, false)</span>
<span class="c1">#12 /app/vendor/yiisoft/yii2/console/controllers/MigrateController.php(300): yii\db\Schema-&gt;getTableSchemas()</span>
<span class="c1">#13 /app/vendor/yiisoft/yii2/console/controllers/BaseMigrateController.php(472): yii\console\controllers\MigrateController-&gt;truncateDatabase()</span>
<span class="c1">#14 [internal function]: yii\console\controllers\BaseMigrateController-&gt;actionFresh()</span>
<span class="c1">#15 /app/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)</span>
<span class="c1">#16 /app/vendor/yiisoft/yii2/base/Controller.php(181): yii\base\InlineAction-&gt;runWithParams(Array)</span>
<span class="c1">#17 /app/vendor/yiisoft/yii2/console/Controller.php(184): yii\base\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#18 /app/vendor/yiisoft/yii2/base/Module.php(534): yii\console\Controller-&gt;runAction(&#39;fresh&#39;, Array)</span>
<span class="c1">#19 /app/vendor/yiisoft/yii2/console/Application.php(181): yii\base\Module-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#20 /app/vendor/yiisoft/yii2/console/Application.php(148): yii\console\Application-&gt;runAction(&#39;migrate/fresh&#39;, Array)</span>
<span class="c1">#21 /app/vendor/yiisoft/yii2/base/Application.php(392): yii\console\Application-&gt;handleRequest(Object(yii\console\Request))</span>
<span class="c1">#22 /app/yii(23): yii\base\Application-&gt;run()</span>
<span class="c1">#23 {main}</span>
Additional Information:

</code></pre></div><h5 id="problem-1">Problem</h5>
<p>The setup thinks its on staging, it is because the variables in <code>.secrets</code> is for staging.</p>
<h5 id="review-4">Review 4</h5>
<p>Update the following variables in gitlab fork:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">FUW_TESTDB_HOST</span><span class="o">=</span>
<span class="nv">FUW_TESTDB_NAME</span><span class="o">=</span>
<span class="nv">FUW_TESTDB_USER</span><span class="o">=</span>
<span class="nv">FUW_TESTDB_PASSWORD</span><span class="o">=</span>
<span class="nv">FUW_DB_HOST</span><span class="o">=</span>
<span class="nv">FUW_DB_NAME</span><span class="o">=</span>
<span class="nv">FUW_DB_USER</span><span class="o">=</span>
<span class="nv">FUW_DB_PASSWORD</span><span class="o">=</span>
<span class="nv">FUW_JWT_KEY</span><span class="o">=</span>
</code></pre></div><h5 id="problem-2">Problem</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">ERROR: <span class="k">for</span> deployment_tusd_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> deployment_ftpd_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> deployment_console_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> deployment_watcher_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> deployment_application_1  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> tusd  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> ftpd  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> console  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> watcher  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>

ERROR: <span class="k">for</span> application  UnixHTTPConnectionPool<span class="o">(</span><span class="nv">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>, <span class="nv">port</span><span class="o">=</span>None<span class="o">)</span>: Read timed out. <span class="o">(</span><span class="nb">read</span> <span class="nv">timeout</span><span class="o">=</span>60<span class="o">)</span>
ERROR: An HTTP request took too long to complete. Retry with --verbose to obtain debug information.
If you encounter this issue regularly because of slow network conditions, consider setting COMPOSE_HTTP_TIMEOUT to a higher value <span class="o">(</span>current value: 60<span class="o">)</span>.
</code></pre></div><h5 id="review-5">Review 5</h5>
<p>Restart the docker daemon to fix the <code>COMPOSE_HTTP_TIMEOUT</code> issue, see <a href="https://github.com/docker/compose/issues/3633">here</a></p>
<h3 id="steps-to-review---go-through-the-steps-mentioned-in-the-fuw-workflow-videohttpsdrivegooglecomfiled1kkmmapx0j8fcyt8ftwce2pkprtu5rq6nviewuspsharing">Steps to review - Go through the steps mentioned in the FUW workflow <a href="https://drive.google.com/file/d/1kkMMApX0J8Fcyt8ftwCe2PKPrtu5rQ6N/view?usp=sharing">video</a></h3>
<ol>
<li>Log in as curator, update the <code>upload status</code> to <code>Curation</code></li>
<li>Click the <code>Move files to public ftp</code> button</li>
<li>The <code>/adminDataset/admin/</code> view:
<img src="/image/curation.png" alt="img.png"></li>
<li>When click <code>View Dataset</code> will get:</li>
</ol>
<pre tabindex="0"><code>Error 500
Trying to get property of non-object
</code></pre><ol start="5">
<li><code>docker-compose logs application</code> will get:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="s2">&#34;Trying to get property of non-object (/var/www/protected/components/StoredDatasetFiles.php:67)&#34;</span>
</code></pre></div><ol start="6">
<li>In <code>StoredDatasetFiles.php</code>, line 67</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="s1">&#39;format&#39;</span> <span class="o">=&gt;</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">format</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span>
</code></pre></div><ol start="7">
<li>To set up <code>production_like</code> test data for gigaDB test database
<code> ./ops/scripts/setup_devdb.sh production_like</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">*** applying m200529_050180_insert_data_species_tab
PHP Fatal error:  Allowed memory size of <span class="m">134217728</span> bytes exhausted <span class="o">(</span>tried to allocate <span class="m">1052672</span> bytes<span class="o">)</span> in /var/www/protected/migrations/data/production_like/m200529_050180_insert_data_species_tab.php on line <span class="m">422203</span>

Fatal error: Allowed memory size of <span class="m">134217728</span> bytes exhausted <span class="o">(</span>tried to allocate <span class="m">1052672</span> bytes<span class="o">)</span> in /var/www/protected/migrations/data/production_like/m200529_050180_insert_data_species_tab.php on line <span class="m">422203</span>
</code></pre></div><ol start="8">
<li>Get the latest commit from Rija fuw-cicd branch and fix the merge conflicts</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">git remote -v
git fetch origin
git merge a90c10a
</code></pre></div><ol start="9">
<li>Then stop, remove and restart the containers</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">docker stop <span class="k">$(</span>docker ps -aq<span class="k">)</span>
docker rm <span class="k">$(</span>docker ps -aq<span class="k">)</span>
./up.sh
</code></pre></div><ol start="10">
<li>
<p>To set up <code>production_like</code> database again<br>
<code>./up.sh production_like</code><br>
But take long time to finish ðŸ˜¢</p>
</li>
<li>
<p>To register an admin user for the smoke test<br>
<code>docker-compose exec console ./yii identity/add-identity --username admin --email local-gigadb-admin@rijam.ml1.net --role admin</code>
Then log in gigadb admin account <code>local-gigadb-admin@rijam.ml1.net</code></p>
</li>
<li>
<p>To register a normal user for the smoke test<br>
<code>docker-compose run --rm test ./protected/yiic smoketest createdata</code><br>
Then log in test account : <code>gigadb-smoke-test-user@rijam.sent.as</code></p>
</li>
<li>
<p>To reset the test data<br>
<code>docker-compose run --rm test ./protected/yiic smoketest resetdata &amp;&amp; docker-compose exec console ./yii fuw/remove-dropbox --doi 000007</code>
<code>docker-compose run --rm test ./protected/yiic smoketest removedata</code></p>
</li>
<li>
<p>To check the job queue<br>
<code>http://fuw-admin-dev.pommetab.com:9170/monitor/jobs</code></p>
</li>
<li>
<p>Found <code>Error: duplicate key value violates unique constraint file_pkey</code></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">gigadb-worker_1      <span class="p">|</span> 2021-06-08 02:58:33 <span class="o">[</span>pid: 1<span class="o">]</span> - Worker is started
gigadb-worker_1      <span class="p">|</span> 2021-06-08 03:22:57 <span class="o">[</span>3<span class="o">]</span> app<span class="se">\m</span>odels<span class="se">\U</span>pdateGigaDBJob <span class="o">(</span>attempt: 1, pid: 1<span class="o">)</span> - Started
gigadb-worker_1      <span class="p">|</span> 2021-06-08 03:22:57 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>warning<span class="o">][</span>application<span class="o">]</span> Update GigaDB <span class="k">for</span> test-image.png <span class="o">(</span>000007<span class="o">)</span>
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:61
gigadb-worker_1      <span class="p">|</span> 2021-06-08 03:22:57 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>warning<span class="o">][</span>application<span class="o">]</span> Creating file record <span class="k">for</span> filetest-image.png <span class="k">for</span> dataset <span class="m">000007</span>
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:85
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:68
gigadb-worker_1      <span class="p">|</span> 2021-06-08 03:22:58 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>error<span class="o">][</span>yii<span class="se">\q</span>ueue<span class="se">\Q</span>ueue<span class="o">]</span> <span class="o">[</span>3<span class="o">]</span> app<span class="se">\m</span>odels<span class="se">\U</span>pdateGigaDBJob <span class="o">(</span>attempt: 1, PID: 1<span class="o">)</span> is finished with error: PDOException: SQLSTATE<span class="o">[</span>23505<span class="o">]</span>: Unique violation: <span class="m">7</span> ERROR:  duplicate key value violates unique constraint <span class="s2">&#34;file_pkey&#34;</span>
gigadb-worker_1      <span class="p">|</span> DETAIL:  Key <span class="o">(</span>id<span class="o">)=(</span>6300<span class="o">)</span> already exists. in /gigadb-apps/worker/file-worker/vendor/yiisoft/yii2/db/Command.php:1302
gigadb-worker_1      <span class="p">|</span> Next yii<span class="se">\d</span>b<span class="se">\I</span>ntegrityException: SQLSTATE<span class="o">[</span>23505<span class="o">]</span>: Unique violation: <span class="m">7</span> ERROR:  duplicate key value violates unique constraint <span class="s2">&#34;file_pkey&#34;</span>
gigadb-worker_1      <span class="p">|</span> DETAIL:  Key <span class="o">(</span>id<span class="o">)=(</span>6300<span class="o">)</span> already exists.
gigadb-worker_1      <span class="p">|</span> The SQL being executed was: INSERT INTO <span class="s2">&#34;file&#34;</span> <span class="o">(</span><span class="s2">&#34;dataset_id&#34;</span>, <span class="s2">&#34;name&#34;</span>, <span class="s2">&#34;size&#34;</span>, <span class="s2">&#34;location&#34;</span>, <span class="s2">&#34;description&#34;</span>, <span class="s2">&#34;extension&#34;</span>, <span class="s2">&#34;format_id&#34;</span>, <span class="s2">&#34;type_id&#34;</span>, <span class="s2">&#34;download_count&#34;</span><span class="o">)</span> VALUES <span class="o">(</span>999999, <span class="s1">&#39;test-image.png&#39;</span>, 530635, <span class="s1">&#39;http://gigadb.gigasciencejournal.com:9170/datasetfiles/000007/test-image.png&#39;</span>, <span class="s1">&#39;test image&#39;</span>, <span class="s1">&#39;PNG&#39;</span>, 10, 41, 0<span class="o">)</span> RETURNING <span class="s2">&#34;id&#34;</span> in /gigadb-apps/worker/file-worker/vendor/yiisoft/yii2/db/Schema.php:678
gigadb-worker_1      <span class="p">|</span> Additional Information:
gigadb-worker_1      <span class="p">|</span> Array
gigadb-worker_1      <span class="p">|</span> <span class="o">(</span>
gigadb-worker_1      <span class="p">|</span>     <span class="o">[</span>0<span class="o">]</span> <span class="o">=</span>&gt; <span class="m">23505</span>
gigadb-worker_1      <span class="p">|</span>     <span class="o">[</span>1<span class="o">]</span> <span class="o">=</span>&gt; <span class="m">7</span>
gigadb-worker_1      <span class="p">|</span>     <span class="o">[</span>2<span class="o">]</span> <span class="o">=</span>&gt; ERROR:  duplicate key value violates unique constraint <span class="s2">&#34;file_pkey&#34;</span>
gigadb-worker_1      <span class="p">|</span> DETAIL:  Key <span class="o">(</span>id<span class="o">)=(</span>6300<span class="o">)</span> already exists.
gigadb-worker_1      <span class="p">|</span> <span class="o">)</span>
gigadb-worker_1      <span class="p">|</span> .
</code></pre></div><ol start="16">
<li>To fix <code>duplicate key value error</code>
<ul>
<li>16.1 Check the <code>id</code> sequence of the table <code>file</code></li>
</ul>
</li>
</ol>
<pre tabindex="0"><code class="language-psql" data-lang="psql">gigadb=# select max(id) from file;
max  

95365
(1 row)
gigadb=# select nextval('file_id_seq');
nextval 

6300
(1 row)
</code></pre><ul>
<li>16.2 Fix the <code>id</code> sequence of the table <code>file</code></li>
</ul>
<pre tabindex="0"><code class="language-psql" data-lang="psql">gigadb=# SELECT setval(pg_get_serial_sequence('file', 'id'), coalesce(max(id),0) + 1, false) FROM file;                                                                                                                                     
setval 

95366
(1 row)
gigadb=# select nextval('file_id_seq');                                                                                                                                                                                                      
nextval 

95366
(1 row)
</code></pre><ol start="17">
<li>
<p>The uploaded smoketest dataset could be seen in <code>http://gigadb.gigasciencejournal.com:9170/dataset/view/id/000007</code><br>
<img src="/image/smoketest-view.png" alt="img.png"></p>
</li>
<li>
<p><code>Attribute ID cannot be blank</code> error.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">gigadb-worker_1      <span class="p">|</span> 2021-06-09 04:15:01 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>warning<span class="o">][</span>application<span class="o">]</span> Update GigaDB <span class="k">for</span> test-image.png <span class="o">(</span>000007<span class="o">)</span>
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:61
gigadb-worker_1      <span class="p">|</span> 2021-06-09 04:15:01 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>warning<span class="o">][</span>application<span class="o">]</span> Creating file record <span class="k">for</span> filetest-image.png <span class="k">for</span> dataset <span class="m">000007</span>
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:85
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:68
gigadb-worker_1      <span class="p">|</span> 2021-06-09 04:15:01 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>warning<span class="o">][</span>application<span class="o">]</span> Creating file_attributes record <span class="k">for</span> test-image.png <span class="o">(</span>000007<span class="o">)</span>
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:113
gigadb-worker_1      <span class="p">|</span>     in /gigadb-apps/worker/file-worker/models/UpdateGigaDBJob.php:69
gigadb-worker_1      <span class="p">|</span> 2021-06-09 04:15:01 <span class="o">[</span>-<span class="o">][</span>-<span class="o">][</span>-<span class="o">][</span>error<span class="o">][</span>application<span class="o">]</span> <span class="o">[</span>
gigadb-worker_1      <span class="p">|</span>     <span class="s1">&#39;attribute_id&#39;</span> <span class="o">=</span>&gt; <span class="o">[</span>
gigadb-worker_1      <span class="p">|</span>         <span class="s1">&#39;Attribute ID cannot be blank.&#39;</span>,
gigadb-worker_1      <span class="p">|</span>     <span class="o">]</span>,
gigadb-worker_1      <span class="p">|</span> <span class="o">]</span>
</code></pre></div><h3 id="steps-to-review----pass-unit-test">Steps to review -  Pass Unit test</h3>
<ol>
<li>Make sure the <code>deployment_test_1</code> container is up<br>
<code>docker-compose build test</code></li>
<li>Run the unit test suite<br>
<code>./test/unit_runner</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">..............................................................  <span class="m">63</span> / <span class="m">279</span> <span class="o">(</span> 22%<span class="o">)</span>
............................................................... <span class="m">126</span> / <span class="m">279</span> <span class="o">(</span> 45%<span class="o">)</span>
............................................................... <span class="m">189</span> / <span class="m">279</span> <span class="o">(</span> 67%<span class="o">)</span>
............................................................... <span class="m">252</span> / <span class="m">279</span> <span class="o">(</span> 90%<span class="o">)</span>
...........................                                     <span class="m">279</span> / <span class="m">279</span> <span class="o">(</span>100%<span class="o">)</span>

Time: 30.2 seconds, Memory: 30.00MB

OK <span class="o">(</span><span class="m">279</span> tests, <span class="m">843</span> assertions<span class="o">)</span>
deployment_console_1         docker-php-entrypoint php-fpm    Up      9000/tcp, 9001/tcp                                                                                                                                                                                                                                                                      
Yii Migration Tool <span class="o">(</span>based on Yii v2.0.42.1<span class="o">)</span>

No new migrations found. Your system is up-to-date.
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Backend<span class="se">\t</span>ests.unit Tests <span class="o">(</span>24<span class="o">)</span> ------------------------------
âœ” DockerManagerTest: Can find matching container <span class="o">(</span>0.32s<span class="o">)</span>
âœ” DockerManagerTest: Cannot find container <span class="o">(</span>0.04s<span class="o">)</span>
âœ” DockerManagerTest: Cannot see forbidden container <span class="o">(</span>0.00s<span class="o">)</span>
âœ” DockerManagerTest: Can make post body <span class="o">(</span>0.01s<span class="o">)</span>
âœ” DockerManagerTest: Can load and run <span class="nb">command</span> <span class="o">(</span>0.06s<span class="o">)</span>
âœ” DockerManagerTest: Can restart container <span class="o">(</span>0.00s<span class="o">)</span>
âœ” FiledropAccountTest: Can create writable directories <span class="o">(</span>0.18s<span class="o">)</span>
âœ” FiledropAccountTest: Can remove directories <span class="o">(</span>0.17s<span class="o">)</span>
âœ” FiledropAccountTest: No op remove directories <span class="o">(</span>0.08s<span class="o">)</span>
âœ” FiledropAccountTest: Can create tokens <span class="o">(</span>0.10s<span class="o">)</span>
âœ” FiledropAccountTest: Create ftp account <span class="o">(</span>0.09s<span class="o">)</span>
âœ” FiledropAccountTest: Remove ftp account <span class="o">(</span>0.09s<span class="o">)</span>
âœ” FiledropAccountTest: Remove uploads <span class="o">(</span>0.11s<span class="o">)</span>
âœ” FiledropAccountTest: Check ftp account <span class="o">(</span>0.10s<span class="o">)</span>
âœ” FiledropAccountTest: Before validate calls account making <span class="k">function</span> <span class="o">(</span>0.09s<span class="o">)</span>
âœ” FiledropAccountTest: Before validate calls account making <span class="k">function</span> preps fails <span class="o">(</span>0.09s<span class="o">)</span>
âœ” FiledropAccountTest: Before validate calls account making <span class="k">function</span> ft pd fails <span class="o">(</span>0.08s<span class="o">)</span>
âœ” FiledropAccountTest: Before validate trigger removal <span class="o">(</span>0.09s<span class="o">)</span>
âœ” MoveJobTest: Move job success <span class="o">(</span>0.14s<span class="o">)</span>
âœ” MoveJobTest: Move job success file exists <span class="o">(</span>0.09s<span class="o">)</span>
âœ” MoveJobTest: Move job upload not found failure <span class="o">(</span>0.12s<span class="o">)</span>
âœ” MoveJobTest: Move job copy failure <span class="o">(</span>0.09s<span class="o">)</span>
âœ” MoveJobTest: Move job throws file not found <span class="o">(</span>0.08s<span class="o">)</span>
âœ” MoveJobTest: Move job create job to update giga db <span class="o">(</span>0.07s<span class="o">)</span>
------------------------------------------------------------


Time: 3.47 seconds, Memory: 30.00MB

OK <span class="o">(</span><span class="m">24</span> tests, <span class="m">69</span> assertions<span class="o">)</span>
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Frontend<span class="se">\t</span>ests.unit Tests <span class="o">(</span>0<span class="o">)</span> ------------------------------
------------------------------------------------------------
DEPRECATION: Calling the <span class="s2">&#34;Symfony\Component\EventDispatcher\EventDispatcherInterface::dispatch()&#34;</span> method with the event name as the first argument is deprecated since Symfony 4.3, pass it as the second argument and provide the event object as the first argument instead. /app/vendor/symfony/event-dispatcher/EventDispatcher.php:58


Time: <span class="m">335</span> ms, Memory: 10.00MB

No tests executed!
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Common<span class="se">\t</span>ests.unit Tests <span class="o">(</span>6<span class="o">)</span> --------------------------------
âœ” MessagingServiceTest: Send email <span class="o">(</span>0.06s<span class="o">)</span>
âœ” UploadTest: Validate data <span class="nb">type</span> error <span class="o">(</span>0.11s<span class="o">)</span>
âœ” UploadTest: Validate data <span class="nb">type</span> no error <span class="o">(</span>0.05s<span class="o">)</span>
âœ” UploadTest: Validate file format error <span class="o">(</span>0.05s<span class="o">)</span>
âœ” UploadTest: Validate file format no error <span class="o">(</span>0.05s<span class="o">)</span>
âœ” UploadTest: Validate filedrop account missing <span class="o">(</span>0.04s<span class="o">)</span>
------------------------------------------------------------


Time: <span class="m">781</span> ms, Memory: 16.00MB

OK <span class="o">(</span><span class="m">6</span> tests, <span class="m">10</span> assertions<span class="o">)</span>
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Console<span class="se">\t</span>ests.unit Tests <span class="o">(</span>10<span class="o">)</span> ------------------------------
âœ” UploadFactoryTest: Get file format from file common <span class="o">(</span>0.02s<span class="o">)</span>
âœ” UploadFactoryTest: Get file format from file regular <span class="o">(</span>0.00s<span class="o">)</span>
âœ” UploadFactoryTest: Get file format from unknown <span class="o">(</span>0.00s<span class="o">)</span>
âœ” UploadFactoryTest: Generate ftp link <span class="o">(</span>0.00s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from file with success <span class="o">(</span>0.06s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from file with failure <span class="o">(</span>0.01s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from json with success <span class="o">(</span>0.01s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from json with malformed json <span class="o">(</span>0.00s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from json with doi mismatch <span class="o">(</span>0.00s<span class="o">)</span>
âœ” UploadFactoryTest: Create upload from json with save failure <span class="o">(</span>0.01s<span class="o">)</span>
------------------------------------------------------------


Time: <span class="m">889</span> ms, Memory: 16.00MB

OK <span class="o">(</span><span class="m">10</span> tests, <span class="m">16</span> assertions<span class="o">)</span>
Codeception PHP Testing Framework v4.1.20
Powered by PHPUnit 8.5.15 by Sebastian Bergmann and contributors.

Unit Tests <span class="o">(</span>6<span class="o">)</span> ---------------------------------------------
âœ” UpdateGigaDBJobTest: Save files <span class="o">(</span>0.19s<span class="o">)</span>
âœ” UpdateGigaDBJobTest: Save attributes <span class="o">(</span>0.14s<span class="o">)</span>
âœ” UpdateGigaDBJobTest: Save samples <span class="o">(</span>0.12s<span class="o">)</span>
âœ” UpdateGigaDBJobTest: Execute <span class="o">(</span>0.12s<span class="o">)</span>
âœ” UpdateGigaDBJobTest: Throw exception when failed to find dataset <span class="o">(</span>0.06s<span class="o">)</span>
âœ” UpdateGigaDBJobTest: Throw exception when dataset wrong status <span class="o">(</span>0.05s<span class="o">)</span>
------------------------------------------------------------


Time: 2.31 seconds, Memory: 18.00 MB

OK <span class="o">(</span><span class="m">6</span> tests, <span class="m">7</span> assertions<span class="o">)</span>

</code></pre></div><h3 id="steps-to-reviews---pass-functional-test">Steps to reviews - Pass Functional test</h3>
<ol>
<li>Make sure the <code>deployment_test_1</code> container is up<br>
<code>docker-compose build test</code></li>
<li>Run the functional test suite<br>
<code>./test/functional_runner</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">................................................................ <span class="m">65</span> / <span class="m">95</span> <span class="o">(</span> 68%<span class="o">)</span>
..............................                                    <span class="m">95</span> / <span class="m">95</span> <span class="o">(</span>100%<span class="o">)</span>

Time: 1.44 minutes, Memory: 34.00MB

OK <span class="o">(</span><span class="m">95</span> tests, <span class="m">294</span> assertions<span class="o">)</span>
Restoring current database...
Restarting php container <span class="k">for</span> deployment project...
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Backend<span class="se">\t</span>ests.functional Tests <span class="o">(</span>10<span class="o">)</span> ------------------------
âœ” FiledropAccountCest: Prepare account <span class="nb">set</span> fields <span class="o">(</span>0.34s<span class="o">)</span>
âœ” FiledropAccountCest: Checking an ftp account <span class="o">(</span>0.23s<span class="o">)</span>
âœ” FiledropAccountCest: Create ftp accounts <span class="o">(</span>0.38s<span class="o">)</span>
âœ” FiledropAccountCest: Create accounts database record <span class="o">(</span>0.41s<span class="o">)</span>
âœ” FiledropAccountCest: Send rest http post to create account <span class="o">(</span>0.57s<span class="o">)</span>
âœ” FiledropAccountCest: Send rest http delete to delete account <span class="o">(</span>0.48s<span class="o">)</span>
âœ” FiledropAccountCest: Send rest http put to update filedrop account and send email <span class="o">(</span>0.42s<span class="o">)</span>
âœ” FiledropAccountCest: Move files <span class="o">(</span>0.25s<span class="o">)</span>
âœ” MockupUrlCest: Add mockup url <span class="o">(</span>0.20s<span class="o">)</span>
âœ” UserCreateCest: Create non existent user <span class="o">(</span>0.53s<span class="o">)</span>
------------------------------------------------------------


Time: 5.98 seconds, Memory: 28.00MB

OK <span class="o">(</span><span class="m">10</span> tests, <span class="m">42</span> assertions<span class="o">)</span>
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Frontend<span class="se">\t</span>ests.functional Tests <span class="o">(</span>6<span class="o">)</span> ------------------------
âœ” AttributeCest: Test <span class="nb">set</span> attributes <span class="o">(</span>0.23s<span class="o">)</span>
âœ” AttributeCest: Test add attributes <span class="o">(</span>0.08s<span class="o">)</span>
âœ” NotificationCest: Email send <span class="o">(</span>0.14s<span class="o">)</span>
âœ” UploadCest: Get upload <span class="o">(</span>0.09s<span class="o">)</span>
âœ” UploadCest: Update single upload <span class="o">(</span>0.07s<span class="o">)</span>
âœ” UploadCest: Update multiple uploads <span class="o">(</span>0.08s<span class="o">)</span>
------------------------------------------------------------


Time: 1.99 seconds, Memory: 22.00MB

OK <span class="o">(</span><span class="m">6</span> tests, <span class="m">32</span> assertions<span class="o">)</span>
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.
Running with seed: 


Console<span class="se">\t</span>ests.functional Tests <span class="o">(</span>7<span class="o">)</span> -------------------------
ftp: DOI <span class="m">300001</span> extracted...
âœ” FtpCest: Try with success to create upload <span class="k">for</span> file <span class="o">(</span>0.25s<span class="o">)</span>
âœ” FtpCest: Try with default options <span class="o">(</span>0.01s<span class="o">)</span>
About to remove the dropbox <span class="k">for</span> 300001...
âœ” FuwCest: Try remove dropbox <span class="o">(</span>0.47s<span class="o">)</span>
actionUpload begins...
âœ” TusdCest: Try with success to create upload <span class="k">for</span> file <span class="o">(</span>0.13s<span class="o">)</span>
actionUpload begins...
âœ” TusdCest: Try create upload <span class="k">for</span> file from json file <span class="o">(</span>0.12s<span class="o">)</span>
actionUpload begins...
âœ” TusdCest: Try create upload <span class="k">for</span> file from json file destination already exists <span class="o">(</span>0.14s<span class="o">)</span>
âœ” TusdCest: Try with default options <span class="o">(</span>0.01s<span class="o">)</span>
------------------------------------------------------------


Time: 1.86 seconds, Memory: 24.00MB

OK <span class="o">(</span><span class="m">7</span> tests, <span class="m">35</span> assertions<span class="o">)</span>

</code></pre></div><h3 id="steps-to-review---pass-acceptance-test">Steps to review - Pass Acceptance test</h3>
<ol>
<li>Make sure the <code>deployment_test_1</code> container is up<br>
<code>docker-compose build test</code></li>
<li>Make sure a headless browser is up
<code>docker-compose up -d chrome</code></li>
<li>Run the acceptance test suite<br>
<code>./test/acceptance_runner</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="m">77</span> scenarios <span class="o">(</span><span class="m">77</span> passed<span class="o">)</span>
<span class="m">734</span> steps <span class="o">(</span><span class="m">734</span> passed<span class="o">)</span>
26m40.98s <span class="o">(</span>16.25Mb<span class="o">)</span>
Codeception PHP Testing Framework v2.5.6
Powered by PHPUnit 6.5.14 by Sebastian Bergmann and contributors.

<span class="o">[</span>Groups<span class="o">]</span> ok 

Common<span class="se">\t</span>ests.acceptance Tests <span class="o">(</span>53<span class="o">)</span> -------------------------
âº Recording âº step-by-step screenshots will be saved to /app/common/tests/_output/
Directory Format: record_60b0ae792a91b_<span class="o">{</span>filename<span class="o">}</span>_<span class="o">{</span>testname<span class="o">}</span> ----
userId: 346, username: joy_fox
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Accessing admin page<span class="s1">&#39;s list of datasets to setup drop box for a dataset (18.70s)
</span><span class="s1">userId: 346, username: joy_fox
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : Triggering the creation of a drop box for a dataset with the appropriate status (23.09s)
</span><span class="s1">userId: 346, username: joy_fox
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : The drop box is created, we can send email instructions (22.71s)
</span><span class="s1">userId: 346, username: joy_fox
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : send default email instructions (22.74s)
</span><span class="s1">userId: 346, username: joy_fox
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : Seeing Popup composer for customizing and sending email instructions (19.70s)
</span><span class="s1">userId: 346, username: joy_fox
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : Popup composer for customizing and sending email instructions (24.71s)
</span><span class="s1">userId: 346, username: artie_dodger
</span><span class="s1">âœ” : ftp upload triggers new upload record saved in database (55.72s)
</span><span class="s1">userId: 346, username: artie_dodger
</span><span class="s1">âœ” : Upload files button when dataset has appropriate status (UserUploadingData) (17.72s)
</span><span class="s1">userId: 346, username: artie_dodger
</span><span class="s1">âœ” : Upload files button when dataset has appropriate status (DataPending) (20.23s)
</span><span class="s1">userId: 346, username: artie_dodger
</span><span class="s1">userId: 347, username: chloe_decker
</span><span class="s1">âœ” : No Upload files button when dataset hasn&#39;</span>t got to the appropriate status yet <span class="o">(</span>23.64s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Pressing the upload button bring up File Upload Wizard upload screen <span class="o">(</span>23.03s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : All files in the queue are uploaded <span class="o">(</span>20.93s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Queued files are all uploaded <span class="o">(</span>11.43s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : There is a Next button <span class="o">(</span>11.83s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Next button to proceed to file metadata annotation form <span class="o">(</span>42.37s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Metadata form elements <span class="k">for</span> all uploaded files <span class="o">(</span>18.50s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Making changes to metadata <span class="o">(</span>17.10s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Saving metadata <span class="o">(</span>23.56s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Removing uploads <span class="o">(</span>20.88s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Initial MD5 checksum <span class="k">for</span> upload files shows up as tooltip <span class="o">(</span>18.71s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : bulk upload form <span class="k">for</span> all uploaded files <span class="o">(</span>19.04s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Uploading CSV spreadsheet to update upload metadata <span class="o">(</span>23.57s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Uploading CSV spreadsheet to update upload metadata and attributes <span class="o">(</span>23.68s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Uploading CSV spreadsheet to update upload metadata, attributes and samples <span class="o">(</span>22.43s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Spreadsheet with malformed attributes <span class="o">(</span>23.59s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Spreadsheet with mispelled column header <span class="o">(</span>21.02s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Unknown Data Type <span class="o">(</span>all spreadsheet entries have error<span class="o">)</span> <span class="o">(</span>21.55s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Unknown Data Type <span class="o">(</span>one spreadsheet entry in error<span class="o">)</span> <span class="o">(</span>28.63s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Unknown file format <span class="o">(</span>one spreadsheet entry in error<span class="o">)</span> <span class="o">(</span>28.31s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Uploading TSV spreadsheet to update upload metadata and attributes <span class="o">(</span>22.80s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Can trigger a form from metadata form <span class="k">for</span> adding new attribute <span class="o">(</span>16.93s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Can add new attribute to the attribute list <span class="o">(</span>18.65s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Can add new samples to a file upload <span class="o">(</span>21.89s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Saving file metadata with attributes and samples <span class="o">(</span>29.47s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : after status is changed to DataAvailableForReview, add entry in curation log <span class="o">(</span>24.12s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Editor <span class="nb">set</span> the status to <span class="s2">&#34;Rejected&#34;</span> causing a curation log entry <span class="o">(</span>8.66s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Editor <span class="nb">set</span> the status to <span class="s2">&#34;Submitted&#34;</span> causing a curation log entry and an email notification <span class="o">(</span>9.18s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : There is a button to generate mockup when status is Submitted <span class="o">(</span>8.51s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : There is not a button to generate mockup when status is not Submitted <span class="o">(</span>6.40s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Generating a mockup when status is Submitted <span class="o">(</span>13.12s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : Can access unique and time-limed url of dataset page showing uploaded files <span class="o">(</span>4.84s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : The page at the unique and time-limed url show dataset info <span class="o">(</span>4.30s<span class="o">)</span>
userId: 346, username: artie_dodger
âœ” : The page at the unique and time-limed url show uploaded files, attributes, samples and download links <span class="o">(</span>13.18s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Curator <span class="nb">set</span> the status to <span class="s2">&#34;DataPending&#34;</span> <span class="k">if</span> something is missing, causing a curation log entry, and email notification <span class="o">(</span>12.86s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Curator <span class="nb">set</span> the status to <span class="s2">&#34;Curation&#34;</span> when files and metadata are complete, causing a curation log entry <span class="o">(</span>9.82s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : there<span class="s1">&#39;s a button to trigger file transfer for dataset with status Curation (6.06s)
</span><span class="s1">userId: 346, username: artie_dodger
</span><span class="s1">userId: 347, username: ben_hur
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">we are in CuratorSteps
</span><span class="s1">âœ” : there&#39;</span>s no button to trigger file transfer <span class="k">for</span> dataset <span class="k">if</span> status not Curation <span class="o">(</span>7.95s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Clicking the move button create a job <span class="k">for</span> the workers <span class="o">(</span>10.68s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : The files are copied to the new location when the workers <span class="nb">complete</span> the job <span class="o">(</span>14.95s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Files that have been moved are marked as such in File Upload Wizard API <span class="o">(</span>16.82s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Completion of moving files triggers update of the file database table <span class="o">(</span>19.54s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Completion of moving files triggers update of the file, attributes tables <span class="o">(</span>21.96s<span class="o">)</span>
userId: 346, username: artie_dodger
userId: 347, username: ben_hur
we are in CuratorSteps
âœ” : Completion of moving files triggers update of the file, attributes and samples tables <span class="o">(</span>21.34s<span class="o">)</span>
------------------------------------------------------------
âº Records saved into: file:///app/common/tests/_output/records.html


Time: 17.34 minutes, Memory: 42.00MB

OK <span class="o">(</span><span class="m">53</span> tests, <span class="m">243</span> assertions<span class="o">)</span>

</code></pre></div><h3 id="steps-to-review---pass-coverage-test">Steps to review - Pass Coverage test</h3>
<ol>
<li>Make sure the <code>deployment_test_1</code> container is up<br>
<code>docker-compose build test</code></li>
<li>Make sure a headless browser is up
<code>docker-compose up -d chrome</code></li>
<li>Run the coverage test suite<br>
<code>./test/coverage_runner</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">..............................................................  <span class="m">63</span> / <span class="m">279</span> <span class="o">(</span> 22%<span class="o">)</span>
............................................................... <span class="m">126</span> / <span class="m">279</span> <span class="o">(</span> 45%<span class="o">)</span>
............................................................... <span class="m">189</span> / <span class="m">279</span> <span class="o">(</span> 67%<span class="o">)</span>
............................................................... <span class="m">252</span> / <span class="m">279</span> <span class="o">(</span> 90%<span class="o">)</span>
...........................                                     <span class="m">279</span> / <span class="m">279</span> <span class="o">(</span>100%<span class="o">)</span>

Time: 56.76 seconds, Memory: 42.00MB

OK <span class="o">(</span><span class="m">279</span> tests, <span class="m">843</span> assertions<span class="o">)</span>


Load coverage clover log:
  - /var/www/protected/runtime/clover.xml
Found <span class="m">275</span> <span class="nb">source</span> files:
  -  35.71% protected/behaviors/ActiveRecordLogableBehavior.php
  -  60.61% protected/behaviors/DatasetBehavior.php
  -   4.70% protected/behaviors/DatasetRelatedTableBehavior.php
  -   0.00% protected/commands/AuthSetupCommand.php
  -   0.00% protected/commands/AutoSendNotificationCommand.php
  -   0.00% protected/commands/CreateSitemapCommand.php
  -   0.00% protected/commands/FixPrefixCommand.php
  -   0.00% protected/commands/GenerateFileFormatsCommand.php
  -   0.00% protected/commands/GenerateFileTypesCommand.php
  -   0.00% protected/commands/GetCitationCommand.php
  -   0.00% protected/commands/ImportCsvCommand.php
  -   0.00% protected/commands/LessCompilerCommand.php
  -   0.00% protected/commands/SequenceFixerCommand.php
  -   0.00% protected/commands/SmokeTestCommand.php
  -  34.38% protected/components/AffiliateUserIdentity.php
  -   0.00% protected/components/AnalyticsService.php
  -  63.16% protected/components/AttributeService.php
  -  85.00% protected/components/AuthorisedDatasetAccessions.php
  -  80.00% protected/components/AuthorisedDatasetSubmitter.php
  - 100.00% protected/components/AutoCompleteService.php
  -  95.45% protected/components/CachedDatasetAccessions.php
  - 100.00% protected/components/CachedDatasetConnections.php
  - 100.00% protected/components/CachedDatasetExternalLinks.php
  - 100.00% protected/components/CachedDatasetFiles.php
  - 100.00% protected/components/CachedDatasetMainSection.php
  - 100.00% protected/components/CachedDatasetSamples.php
  -  91.67% protected/components/CachedDatasetSubmitter.php
  -   0.00% protected/components/Controller.php
  -   0.00% protected/components/DatabaseSearch.php
  - 100.00% protected/components/DatasetComponents.php
  - 100.00% protected/components/DatasetFiledrop.php
  -  97.83% protected/components/DatasetPageAssembly.php
  - 100.00% protected/components/DatasetPageSettings.php
  -  82.86% protected/components/DatasetUpload.php
  -   0.00% protected/components/DeferrableCJuiAutoComplete.php
  -  71.21% protected/components/FileUploadService.php
  -  73.72% protected/components/FiledropService.php
  -   0.00% protected/components/FilesPagination.php
  -  86.36% protected/components/FormattedDatasetAccessions.php
  -  94.74% protected/components/FormattedDatasetConnections.php
  -  77.78% protected/components/FormattedDatasetExternalLinks.php
  - 100.00% protected/components/FormattedDatasetFiles.php
  -  92.68% protected/components/FormattedDatasetMainSection.php
  -  91.30% protected/components/FormattedDatasetSamples.php
  -  88.89% protected/components/LinkWithFormat.php
  - 100.00% protected/components/LinkWithPreference.php
  - 100.00% protected/components/MailService.php
  -   0.00% protected/components/MySort.php
  -   0.00% protected/components/NewsAndFeedsService.php
  -  95.65% protected/components/NewsletterService.php
  -   0.00% protected/components/OrcidStrategy.php
  - 100.00% protected/components/ResourcedDatasetFiles.php
  -   0.00% protected/components/SiteLinkPager.php
  -  93.33% protected/components/StoredDatasetAccessions.php
  -  82.35% protected/components/StoredDatasetConnections.php
  - 100.00% protected/components/StoredDatasetExternalLinks.php
  - 100.00% protected/components/StoredDatasetFiles.php
  - 100.00% protected/components/StoredDatasetMainSection.php
  - 100.00% protected/components/StoredDatasetSamples.php
  -  92.31% protected/components/StoredDatasetSubmitter.php
  -   0.00% protected/components/SuUserIdentity.php
  -  93.65% protected/components/TokenService.php
  -  92.86% protected/components/UserIdentity.php
  -   0.00% protected/components/Util.php
  -   0.00% protected/components/WebUser.php
  -  38.92% protected/components/Yii.php
  -   0.00% protected/config/console.php
  -   0.00% protected/config/local.php
  -   0.00% protected/config/main.php
  -   0.00% protected/config/test.php
  -   0.00% protected/config/yii2/params-local.php
  -   0.00% protected/config/yii2/params.php
  -   0.00% protected/config/yii2/test.php
  -   0.00% protected/config/yii2/web.php
  -   0.00% protected/controllers/AdminAuthorController.php
  -   0.00% protected/controllers/AdminDatasetAuthorController.php
  -   0.00% protected/controllers/AdminDatasetController.php
  -   0.00% protected/controllers/AdminDatasetProjectController.php
  -   0.00% protected/controllers/AdminDatasetSampleController.php
  -   0.00% protected/controllers/AdminDatasetTypeController.php
  -   0.00% protected/controllers/AdminExternalLinkController.php
  -   0.00% protected/controllers/AdminFileController.php
  -   0.00% protected/controllers/AdminFileFormatController.php
  -   0.00% protected/controllers/AdminFileTypeController.php
  -   0.00% protected/controllers/AdminImagesController.php
  -   0.00% protected/controllers/AdminLinkController.php
  -   0.00% protected/controllers/AdminLinkPrefixController.php
  -   0.00% protected/controllers/AdminManuscriptController.php
  -   0.00% protected/controllers/AdminProjectController.php
  -   0.00% protected/controllers/AdminPublisherController.php
  -   0.00% protected/controllers/AdminRelationController.php
  -   0.00% protected/controllers/AdminSampleController.php
  -   0.00% protected/controllers/AdminSpeciesController.php
  -   0.00% protected/controllers/AdminUserCommandController.php
  -   0.00% protected/controllers/ApiController.php
  -   0.00% protected/controllers/AttributeController.php
  -   0.00% protected/controllers/AuthorisedDatasetController.php
  -   0.00% protected/controllers/CurationLogController.php
  -   0.00% protected/controllers/Dataset/MockupViewAction.php
  -   0.00% protected/controllers/DatasetController.php
  -   0.00% protected/controllers/DatasetFunderController.php
  -   0.00% protected/controllers/DatasetLogController.php
  -   0.00% protected/controllers/DatasetSubmissionController.php
  -   0.00% protected/controllers/FunderController.php
  -   0.00% protected/controllers/NewsController.php
  -   0.00% protected/controllers/PolicyController.php
  -   0.00% protected/controllers/ReportController.php
  -   0.00% protected/controllers/RssController.php
  -   0.00% protected/controllers/RssMessageController.php
  -   0.00% protected/controllers/SearchController.php
  -   0.00% protected/controllers/SiteController.php
  -   0.00% protected/controllers/UserCommandController.php
  -   0.00% protected/controllers/UserController.php
  -   0.00% protected/controllers/adminDataset/AssignFTPBoxAction.php
  -   0.00% protected/controllers/adminDataset/MockupAction.php
  -   0.00% protected/controllers/adminDataset/MoveFilesAction.php
  -   0.00% protected/controllers/adminDataset/SaveInstructionsAction.php
  -   0.00% protected/controllers/adminDataset/SendInstructionsAction.php
  -   0.00% protected/controllers/authorisedDataset/FilesAnnotateAction.php
  -   0.00% protected/controllers/authorisedDataset/FilesUploadAction.php
  -  83.33% protected/helpers/HTTPSHelper.php
  - 100.00% protected/helpers/PasswordHelper.php
  -   0.00% protected/interfaces/Cacheable.php
  -   0.00% protected/interfaces/DatasetAccessionsInterface.php
  -   0.00% protected/interfaces/DatasetConnectionsInterface.php
  -   0.00% protected/interfaces/DatasetExternalLinksInterface.php
  -   0.00% protected/interfaces/DatasetFilesInterface.php
  -   0.00% protected/interfaces/DatasetMainSectionInterface.php
  -   0.00% protected/interfaces/DatasetSamplesInterface.php
  -   0.00% protected/interfaces/DatasetSubmitterInterface.php
  -   0.00% protected/interfaces/LinkInterface.php
  -   0.00% protected/messages/config.php
  -   0.00% protected/messages/en/app.php
  -   0.00% protected/messages/zh_tw/app.php
  -   0.00% protected/models/AlternativeIdentifiers.php
  -  28.57% protected/models/Attribute.php
  -  61.29% protected/models/Author.php
  -  42.86% protected/models/AuthorRel.php
  -   0.00% protected/models/ChangePasswordForm.php
  -   0.00% protected/models/ContactForm.php
  -  44.83% protected/models/CurationLog.php
  -  15.35% protected/models/Dataset.php
  -  56.52% protected/models/DatasetAttributes.php
  -  77.78% protected/models/DatasetAttributesFactory.php
  -   9.52% protected/models/DatasetAuthor.php
  -  92.86% protected/models/DatasetDAO.php
  -   7.41% protected/models/DatasetFunder.php
  -   6.25% protected/models/DatasetLog.php
  -  10.53% protected/models/DatasetProject.php
  -  10.53% protected/models/DatasetSample.php
  -   0.00% protected/models/DatasetSession.php
  -   6.06% protected/models/DatasetType.php
  -   0.00% protected/models/EditProfileForm.php
  -   0.00% protected/models/ExpAttributes.php
  -   0.00% protected/models/Experiment.php
  -   0.00% protected/models/Extdb.php
  -  11.11% protected/models/ExternalLink.php
  -   6.67% protected/models/ExternalLinkType.php
  -  16.82% protected/models/File.php
  -  15.38% protected/models/FileAttributes.php
  -  50.00% protected/models/FileFormat.php
  - 100.00% protected/models/FileFormatDAO.php
  -   0.00% protected/models/FileRelationship.php
  -   8.33% protected/models/FileSample.php
  -  50.00% protected/models/FileType.php
  - 100.00% protected/models/FileTypeDAO.php
  -   0.00% protected/models/Folder.php
  -   8.33% protected/models/Funder.php
  -   0.00% protected/models/ImageHaver.php
  -   0.00% protected/models/Images.php
  -  53.85% protected/models/Link.php
  -   0.00% protected/models/LoginForm.php
  -  12.50% protected/models/Manuscript.php
  -   0.00% protected/models/News.php
  -  18.75% protected/models/Prefix.php
  -   4.17% protected/models/Project.php
  -   6.25% protected/models/Publisher.php
  -   0.00% protected/models/PxInfoForm.php
  - 100.00% protected/models/RSSFeedDAO.php
  -  14.29% protected/models/Relation.php
  - 100.00% protected/models/RelationDAO.php
  -  46.15% protected/models/Relationship.php
  -  27.27% protected/models/RssMessage.php
  -  13.61% protected/models/Sample.php
  -  37.50% protected/models/SampleAttribute.php
  -   0.00% protected/models/SampleRel.php
  -   0.00% protected/models/SearchForm.php
  -   0.00% protected/models/SearchRecord.php
  -  10.53% protected/models/Species.php
  -   4.76% protected/models/Type.php
  -   0.00% protected/models/Unit.php
  -  18.75% protected/models/User.php
  -   0.00% protected/models/UserCommand.php
  - 100.00% protected/models/UserDAO.php
  -   0.00% protected/modules/opauth/OpauthModule.php
  -   0.00% protected/modules/opauth/controllers/CallbackController.php
  -  75.00% protected/tests/functional/AdminDatasetAssignFTPBoxActionTest.php
  -  92.50% protected/tests/functional/AdminDatasetMockupActionTest.php
  -  96.67% protected/tests/functional/AdminDatasetMoveFilesActionTest.php
  -  89.19% protected/tests/functional/AdminDatasetSendInstructionsActionTest.php
  -  93.65% protected/tests/functional/AdminDatasetUpdateActionTest.php
  - 100.00% protected/tests/functional/AdminFileTest.php
  - 100.00% protected/tests/functional/AdminSiteAccessTest.php
  - 100.00% protected/tests/functional/AnalyticsTest.php
  - 100.00% protected/tests/functional/ApiTest.php
  -  98.41% protected/tests/functional/AuthorisedDatasetFilesAnnotateActionTest.php
  -  97.98% protected/tests/functional/AuthorisedDatasetFilesUploadActionTest.php
  -  90.00% protected/tests/functional/AutoCompleteEndpointsTest.php
  - 100.00% protected/tests/functional/CaptchaImageTest.php
  -  96.55% protected/tests/functional/DatasetKeywordsTest.php
  -  92.31% protected/tests/functional/DatasetMockupViewActionTest.php
  - 100.00% protected/tests/functional/DatasetViewTest.php
  - 100.00% protected/tests/functional/FileUploadServiceTest.php
  -  98.32% protected/tests/functional/FiledropServiceTest.php
  -  77.14% protected/tests/functional/MailServiceTest.php
  - 100.00% protected/tests/functional/NewsletterTest.php
  - 100.00% protected/tests/functional/RSSFeedTest.php
  - 100.00% protected/tests/functional/SearchViewTest.php
  - 100.00% protected/tests/functional/SiteTest.php
  - 100.00% protected/tests/support/BrowserFindSteps.php
  - 100.00% protected/tests/support/BrowserFormSteps.php
  -  94.44% protected/tests/support/BrowserPageSteps.php
  - 100.00% protected/tests/support/BrowserSignInSteps.php
  -   0.00% protected/tests/support/CommonDataProviders.php
  -  98.78% protected/tests/support/DatabaseSteps.php
  - 100.00% protected/tests/support/FilesystemSteps.php
  - 100.00% protected/tests/support/FunctionalTesting.php
  - 100.00% protected/tests/unit/AffiliateUserIdentityTest.php
  -  93.75% protected/tests/unit/AttributeServiceTest.php
  - 100.00% protected/tests/unit/AuthorTest.php
  - 100.00% protected/tests/unit/AuthorisedDatasetAccessionsTest.php
  -  80.00% protected/tests/unit/AutoCompleteServiceTest.php
  - 100.00% protected/tests/unit/CachedDatasetAccessionsTest.php
  - 100.00% protected/tests/unit/CachedDatasetConnectionsTest.php
  - 100.00% protected/tests/unit/CachedDatasetExternalLinksTest.php
  - 100.00% protected/tests/unit/CachedDatasetFilesTest.php
  -  99.71% protected/tests/unit/CachedDatasetMainSectionTest.php
  - 100.00% protected/tests/unit/CachedDatasetSamplesTest.php
  - 100.00% protected/tests/unit/CurationLogTest.php
  - 100.00% protected/tests/unit/DatasetAttributesFactoryTest.php
  - 100.00% protected/tests/unit/DatasetAttributesTest.php
  -  98.94% protected/tests/unit/DatasetDAOTest.php
  - 100.00% protected/tests/unit/DatasetFildedropTest.php
  - 100.00% protected/tests/unit/DatasetPageAssemblyTest.php
  - 100.00% protected/tests/unit/DatasetPageSettingsTest.php
  -  98.72% protected/tests/unit/DatasetSubmitterDataTest.php
  - 100.00% protected/tests/unit/DatasetTest.php
  - 100.00% protected/tests/unit/DatasetUploadTest.php
  - 100.00% protected/tests/unit/FileFormatDAOTest.php
  -  91.67% protected/tests/unit/FileTest.php
  - 100.00% protected/tests/unit/FileTypeDAOTest.php
  - 100.00% protected/tests/unit/FiledropServiceTest.php
  - 100.00% protected/tests/unit/FormattedDatasetAccessionsTest.php
  - 100.00% protected/tests/unit/FormattedDatasetConnectionsTest.php
  - 100.00% protected/tests/unit/FormattedDatasetExternalLinksTest.php
  - 100.00% protected/tests/unit/FormattedDatasetFilesTest.php
  - 100.00% protected/tests/unit/FormattedDatasetMainSectionTest.php
  - 100.00% protected/tests/unit/FormattedDatasetSamplesTest.php
  -  66.67% protected/tests/unit/HTTPSHelperTest.php
  -  97.92% protected/tests/unit/NewsLetterServiceTest.php
  - 100.00% protected/tests/unit/PasswordHelperTest.php
  - 100.00% protected/tests/unit/RSSFeedDAOTest.php
  -  96.00% protected/tests/unit/RelationDAOTest.php
  - 100.00% protected/tests/unit/ResourcedDatasetFilesTest.php
  - 100.00% protected/tests/unit/StoredDatasetAccessionsTest.php
  - 100.00% protected/tests/unit/StoredDatasetConnectionsTest.php
  - 100.00% protected/tests/unit/StoredDatasetExternalLinksTest.php
  - 100.00% protected/tests/unit/StoredDatasetFilesTest.php
  -  98.31% protected/tests/unit/StoredDatasetMainSectionTest.php
  - 100.00% protected/tests/unit/StoredDatasetSamplesTest.php
  - 100.00% protected/tests/unit/TokenServiceTest.php
  - 100.00% protected/tests/unit/UserDAOTest.php
  - 100.00% protected/tests/unit/UserIdentityTest.php
  - 100.00% protected/tests/unit/UserTest.php
  -   0.00% protected/yiit.php
Coverage:  46.35% <span class="o">(</span>6859/14797<span class="o">)</span>
Collect git info
Read environment variables
Dump submitting json file: /var/www/protected/runtime/coveralls-upload.json
File size: 1,688.08 kB
Submitting to https://coveralls.io/api/v1/jobs
Finish submitting. status: <span class="m">200</span> OK
Accepted Job <span class="c1">##1405.1</span>
You can see the build on https://coveralls.io/jobs/81024590
elapsed time: 7.551 sec memory: 10.00 MB
phpcov 3.1.0 by Sebastian Bergmann.


Generating code coverage report in Clover XML format ... <span class="k">done</span>

Generating code coverage report in HTML format ... <span class="k">done</span>


Code Coverage Report:         
  2021-05-28 09:17:26         
                              
 Summary:                     
  Classes: 31.10% <span class="o">(</span>79/254<span class="o">)</span>    
  Methods: 41.20% <span class="o">(</span>691/1677<span class="o">)</span>  
  Lines:   46.36% <span class="o">(</span>6859/14795<span class="o">)</span>

</code></pre></div><h3 id="reference">Reference</h3>
<p><a href="https://travis-ci.com/kencho51/gigathing"><img src="https://travis-ci.com/kencho51/gigathing.svg?branch=master" alt="Build Status"></a></p>

</div>

        <footer class="post-footer clearfix">
        <p class="post-tags">
            <span>Tagged:</span>
                <a href="/tags/fuw/">fuw</a>
        </p>
    <div class="share">
    </div>
</footer>

        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a href="https://kencho51.github.io/">kencho51</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#" aria-label="Back to Top">
                        <i class="fa fa-angle-up" aria-hidden="true"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2021 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="https://kencho51.github.io/js/jquery-1.11.3.min.js"></script>
        <script src="https://kencho51.github.io/js/jquery.fitvids.js"></script>
        <script src="https://kencho51.github.io/js/scripts.js"></script>
    </body>
</html>

